<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Test.Utils.Ports</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Test.Utils.Ports.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-wallet-test-utils-2019.6.24: Shared utilities for writing unit and property tests.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>&#169; 2018-2019 IOHK</td></tr><tr><th>License</th><td>Apache-2.0</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Test.Utils.Ports</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Provides functions for checking if TCP ports are available to listen
 on. These can be used to start servers for testing when there may be multiple
 test suites running in parallel.</p><p>Includes code from nh2: <a href="https://stackoverflow.com/a/57022572">https://stackoverflow.com/a/57022572</a></p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:randomUnusedTCPPorts">randomUnusedTCPPorts</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>]</li><li class="src short"><a href="#v:findPort">findPort</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:isPortOpen">isPortOpen</a> :: SockAddr -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:simpleSockAddr">simpleSockAddr</a> :: (<a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>) -&gt; PortNumber -&gt; SockAddr</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:randomUnusedTCPPorts" class="def">randomUnusedTCPPorts</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a>] <a href="src/Test.Utils.Ports.html#randomUnusedTCPPorts" class="link">Source</a> <a href="#v:randomUnusedTCPPorts" class="selflink">#</a></p><div class="doc"><p>Get a list of random TCPv4 ports that currently do not have any servers
 listening on them. It may return less than the requested number of ports.</p><p>Note that this method of allocating ports is subject to race
 conditions. Production code should use better methods such as passing a
 listening socket to the child process.</p></div></div><div class="top"><p class="src"><a id="v:findPort" class="def">findPort</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Test.Utils.Ports.html#findPort" class="link">Source</a> <a href="#v:findPort" class="selflink">#</a></p><div class="doc"><p>Returen a single TCP port that was unused at the time this function was
 called.</p></div></div><div class="top"><p class="src"><a id="v:isPortOpen" class="def">isPortOpen</a> :: SockAddr -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Test.Utils.Ports.html#isPortOpen" class="link">Source</a> <a href="#v:isPortOpen" class="selflink">#</a></p><div class="doc"><p>Checks whether <code>connect()</code> to a given TCPv4 <code>SockAddr</code> succeeds or
 returns <code><a href="../base-4.12.0.0/Foreign-C-Error.html#v:eCONNREFUSED" title="Foreign.C.Error">eCONNREFUSED</a></code>.</p><p>Rethrows connection exceptions in all other cases (e.g. when the host
 is unroutable).</p></div></div><div class="top"><p class="src"><a id="v:simpleSockAddr" class="def">simpleSockAddr</a> :: (<a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>, <a href="../base-4.12.0.0/Data-Word.html#t:Word8" title="Data.Word">Word8</a>) -&gt; PortNumber -&gt; SockAddr <a href="src/Test.Utils.Ports.html#simpleSockAddr" class="link">Source</a> <a href="#v:simpleSockAddr" class="selflink">#</a></p><div class="doc"><p>Creates a <code>SockAttr</code> from host IP and port number.</p><p>Example:
 &gt; simpleSockAddr (127,0,0,1) 8000</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>