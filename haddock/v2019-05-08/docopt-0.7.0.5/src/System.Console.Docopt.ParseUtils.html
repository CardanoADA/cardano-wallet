<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Console.Docopt.ParseUtils</span><span>
</span><a name="line-2"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-3"></a><span>        </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.Docopt.ParseUtils.html"><span class="hs-identifier">System.Console.Docopt.ParseUtils</span></a><span class="hs-special">,</span><span>
</span><a name="line-4"></a><span>        </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.Docopt.ApplicativeParsec.html"><span class="hs-identifier">System.Console.Docopt.ApplicativeParsec</span></a><span class="hs-special">,</span><span>
</span><a name="line-5"></a><span>        </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Char</span><span class="hs-special">,</span><span>
</span><a name="line-6"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Docopt.ApplicativeParsec.html"><span class="hs-identifier">System.Console.Docopt.ApplicativeParsec</span></a><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isSpace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toUpper</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toLower</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">-- * Constants</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-identifier">lowers</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">uppers</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">letters</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">numerics</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">specialChars</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">alphanumerics</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">alphanumSpecial</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-19"></a><a name="lowers"><a href="System.Console.Docopt.ParseUtils.html#lowers"><span class="hs-identifier">lowers</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-char">'a'</span><span class="hs-glyph">..</span><span class="hs-char">'z'</span><span class="hs-special">]</span><span>
</span><a name="line-20"></a><a name="uppers"><a href="System.Console.Docopt.ParseUtils.html#uppers"><span class="hs-identifier">uppers</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-char">'A'</span><span class="hs-glyph">..</span><span class="hs-char">'Z'</span><span class="hs-special">]</span><span>
</span><a name="line-21"></a><a name="letters"><a href="System.Console.Docopt.ParseUtils.html#letters"><span class="hs-identifier">letters</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#lowers"><span class="hs-identifier hs-var">lowers</span></a><span class="hs-operator hs-var">++</span><a href="System.Console.Docopt.ParseUtils.html#uppers"><span class="hs-identifier hs-var">uppers</span></a><span>
</span><a name="line-22"></a><a name="numerics"><a href="System.Console.Docopt.ParseUtils.html#numerics"><span class="hs-identifier">numerics</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-char">'0'</span><span class="hs-glyph">..</span><span class="hs-char">'9'</span><span class="hs-special">]</span><span class="hs-operator hs-var">++</span><span class="hs-string">&quot;-_&quot;</span><span>
</span><a name="line-23"></a><a name="specialChars"><a href="System.Console.Docopt.ParseUtils.html#specialChars"><span class="hs-identifier">specialChars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; :/&quot;</span><span>
</span><a name="line-24"></a><a name="alphanumerics"><a href="System.Console.Docopt.ParseUtils.html#alphanumerics"><span class="hs-identifier">alphanumerics</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#letters"><span class="hs-identifier hs-var">letters</span></a><span class="hs-operator hs-var">++</span><a href="System.Console.Docopt.ParseUtils.html#numerics"><span class="hs-identifier hs-var">numerics</span></a><span>
</span><a name="line-25"></a><a name="alphanumSpecial"><a href="System.Console.Docopt.ParseUtils.html#alphanumSpecial"><span class="hs-identifier">alphanumSpecial</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#alphanumerics"><span class="hs-identifier hs-var">alphanumerics</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#specialChars"><span class="hs-identifier hs-var">specialChars</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- * Basic Parsers</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-identifier">caseInsensitive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034568"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-31"></a><a name="caseInsensitive"><a href="System.Console.Docopt.ParseUtils.html#caseInsensitive"><span class="hs-identifier">caseInsensitive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679034997"><a href="#local-6989586621679034997"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toLower</span><span> </span><a href="#local-6989586621679034997"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toUpper</span><span> </span><a href="#local-6989586621679034997"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-identifier">lookAhead_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034566"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034567"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034566"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><a name="lookAhead_"><a href="System.Console.Docopt.ParseUtils.html#lookAhead_"><span class="hs-identifier">lookAhead_</span></a></a><span> </span><a name="local-6989586621679035336"><a href="#local-6989586621679035336"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">lookAhead</span><span> </span><a href="#local-6989586621679035336"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-35"></a><span>                  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-identifier">isNotFollowedBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679034564"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034565"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034564"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034565"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-38"></a><a name="isNotFollowedBy"><a href="System.Console.Docopt.ParseUtils.html#isNotFollowedBy"><span class="hs-identifier">isNotFollowedBy</span></a></a><span> </span><a name="local-6989586621679035337"><a href="#local-6989586621679035337"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">option</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">notFollowedBy</span><span> </span><a href="#local-6989586621679035337"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-identifier">isInlineSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-41"></a><a name="isInlineSpace"><a href="System.Console.Docopt.ParseUtils.html#isInlineSpace"><span class="hs-identifier">isInlineSpace</span></a></a><span> </span><a name="local-6989586621679035338"><a href="#local-6989586621679035338"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">notElem</span><span> </span><a href="#local-6989586621679035338"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-string">&quot;\n\r&quot;</span><span>
</span><a name="line-42"></a><span>                   </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span> </span><a href="#local-6989586621679035338"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-identifier">inlineSpace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034563"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-45"></a><a name="inlineSpace"><a href="System.Console.Docopt.ParseUtils.html#inlineSpace"><span class="hs-identifier">inlineSpace</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">satisfy</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#isInlineSpace"><span class="hs-identifier hs-var">isInlineSpace</span></a><span>
</span><a name="line-46"></a><span>            </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;inline-space&quot;</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | like `spaces`, except does not match newlines</span><span>
</span><a name="line-49"></a><span class="hs-identifier">inlineSpaces</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034562"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><a name="inlineSpaces"><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier">inlineSpaces</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">skipMany</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">satisfy</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#isInlineSpace"><span class="hs-identifier hs-var">isInlineSpace</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>             </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;inline-spaces&quot;</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">inlineSpaces1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034561"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><a name="inlineSpaces1"><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces1"><span class="hs-identifier">inlineSpaces1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">skipMany1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">satisfy</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#isInlineSpace"><span class="hs-identifier hs-var">isInlineSpace</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>              </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;1+ inline-spaces&quot;</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">spaces1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034560"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><a name="spaces1"><a href="System.Console.Docopt.ParseUtils.html#spaces1"><span class="hs-identifier">spaces1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">skipMany1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">satisfy</span><span> </span><span class="hs-identifier hs-var">isSpace</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>        </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;&gt;=1 spaces&quot;</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-identifier">endline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034559"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-62"></a><a name="endline"><a href="System.Console.Docopt.ParseUtils.html#endline"><span class="hs-identifier">endline</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">newline</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">optionalEndline</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034558"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><a name="optionalEndline"><a href="System.Console.Docopt.ParseUtils.html#optionalEndline"><span class="hs-identifier">optionalEndline</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">optional</span><span> </span><span class="hs-identifier hs-var">newline</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-identifier">pipe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034557"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-68"></a><a name="pipe"><a href="System.Console.Docopt.ParseUtils.html#pipe"><span class="hs-identifier">pipe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'|'</span><span> </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;'|'&quot;</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-identifier">ellipsis</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034556"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-71"></a><a name="ellipsis"><a href="System.Console.Docopt.ParseUtils.html#ellipsis"><span class="hs-identifier">ellipsis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;...&quot;</span><span>
</span><a name="line-72"></a><span>         </span><span class="hs-operator hs-var">&lt;?&gt;</span><span> </span><span class="hs-string">&quot;'...'&quot;</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">manyTill1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034553"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034554"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034553"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034555"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034553"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034554"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-75"></a><a name="manyTill1"><a href="System.Console.Docopt.ParseUtils.html#manyTill1"><span class="hs-identifier">manyTill1</span></a></a><span> </span><a name="local-6989586621679036460"><a href="#local-6989586621679036460"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679036461"><a href="#local-6989586621679036461"><span class="hs-identifier">end</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-6989586621679036462"><a href="#local-6989586621679036462"><span class="hs-identifier">first</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679036460"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-77"></a><span>  </span><a name="local-6989586621679036463"><a href="#local-6989586621679036463"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">manyTill</span><span> </span><a href="#local-6989586621679036460"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679036461"><span class="hs-identifier hs-var">end</span></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679036462"><span class="hs-identifier hs-var">first</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679036463"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- |@skipUntil p@ ignores everything that comes before `p`.</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- Returns what `p` returns.</span><span>
</span><a name="line-82"></a><span class="hs-identifier">skipUntil</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679034551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034552"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034551"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034552"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><a name="skipUntil"><a href="System.Console.Docopt.ParseUtils.html#skipUntil"><span class="hs-identifier">skipUntil</span></a></a><span> </span><a name="local-6989586621679036464"><a href="#local-6989586621679036464"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">skipMany</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">notFollowedBy</span><span> </span><a href="#local-6989586621679036464"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">anyChar</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-identifier">pGroup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034549"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034550"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034549"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034550"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-86"></a><a name="pGroup"><a href="System.Console.Docopt.ParseUtils.html#pGroup"><span class="hs-identifier">pGroup</span></a></a><span> </span><a name="local-6989586621679036465"><a href="#local-6989586621679036465"><span class="hs-identifier">beg</span></a></a><span> </span><a name="local-6989586621679036466"><a href="#local-6989586621679036466"><span class="hs-identifier">elemParser</span></a></a><span> </span><a name="local-6989586621679036467"><a href="#local-6989586621679036467"><span class="hs-identifier">end</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">between</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><a href="#local-6989586621679036465"><span class="hs-identifier hs-var">beg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><a href="#local-6989586621679036467"><span class="hs-identifier hs-var">end</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>                            </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">notFollowedBy</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#pipe"><span class="hs-identifier hs-var">pipe</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621679036466"><span class="hs-identifier hs-var">elemParser</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>                              </span><span class="hs-special">`</span><span class="hs-identifier hs-var">sepBy</span><span class="hs-special">`</span><span>
</span><a name="line-89"></a><span>                              </span><span class="hs-special">(</span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#pipe"><span class="hs-identifier hs-var">pipe</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-identifier">betweenS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034547"><span class="hs-identifier hs-type">u</span></a><span> </span><a href="#local-6989586621679034548"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">CharParser</span><span> </span><a href="#local-6989586621679034547"><span class="hs-identifier hs-type">u</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679034548"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-92"></a><a name="betweenS"><a href="System.Console.Docopt.ParseUtils.html#betweenS"><span class="hs-identifier">betweenS</span></a></a><span> </span><a name="local-6989586621679036468"><a href="#local-6989586621679036468"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679036469"><a href="#local-6989586621679036469"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679036470"><a href="#local-6989586621679036470"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">between</span><span> </span><a href="#local-6989586621679036471"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679036472"><span class="hs-identifier hs-var">end</span></a><span> </span><a href="#local-6989586621679036473"><span class="hs-identifier hs-var">manyP</span></a><span>
</span><a name="line-93"></a><span>                 </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679036471"><a href="#local-6989586621679036471"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">string</span><span> </span><a href="#local-6989586621679036468"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-94"></a><span>                       </span><a name="local-6989586621679036472"><a href="#local-6989586621679036472"><span class="hs-identifier">end</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces"><span class="hs-identifier hs-var">inlineSpaces</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">string</span><span> </span><a href="#local-6989586621679036469"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-95"></a><span>                       </span><a name="local-6989586621679036473"><a href="#local-6989586621679036473"><span class="hs-identifier">manyP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036470"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">sepBy</span><span class="hs-special">`</span><span> </span><a href="System.Console.Docopt.ParseUtils.html#inlineSpaces1"><span class="hs-identifier hs-var">inlineSpaces1</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Data.Map utils</span><span>
</span><a name="line-99"></a><span class="hs-identifier">alterAllWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679033707"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033707"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679033708"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679033708"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679033707"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679033707"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679033708"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679033707"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679033708"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-100"></a><a name="alterAllWithKey"><a href="System.Console.Docopt.ParseUtils.html#alterAllWithKey"><span class="hs-identifier">alterAllWithKey</span></a></a><span> </span><a name="local-6989586621679036474"><a href="#local-6989586621679036474"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036475"><a href="#local-6989586621679036475"><span class="hs-identifier">ks</span></a></a><span> </span><a name="local-6989586621679036476"><a href="#local-6989586621679036476"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679036477"><a href="#local-6989586621679036477"><span class="hs-identifier">m'</span></a></a><span> </span><a name="local-6989586621679036478"><a href="#local-6989586621679036478"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">M.alter</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036474"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036478"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036478"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679036477"><span class="hs-identifier hs-var">m'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036476"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679036475"><span class="hs-identifier hs-var">ks</span></a><span>
</span><a name="line-101"></a></pre></body></html>